FROM gakaki/spring_base:latest as builder

WORKDIR /app
COPY . .
RUN  gradle nativeCompile

# FROM bellsoft/liberica-native-image-kit-container:jdk-17-nik-22.2-stream-musl
# FROM bellsoft/liberica-native-image-kit-container:latest
FROM bellsoft/alpaquita-linux-base:stream-musl
# FROM debian:stable-slim
# FROM alpine
# FROM scratch

# Import from builder.
COPY --from=builder /etc/passwd /etc/passwd
COPY --from=builder /etc/group /etc/group

WORKDIR /app
EXPOSE 8080
COPY --from=builder /app/build/native/nativeCompile/java ./
RUN ls
USER app:app
ENTRYPOINT ["/app/java"]
# CMD ["/app/java"]
